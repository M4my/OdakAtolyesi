<!DOCTYPE html>
<html lang="tr">
<head>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odak Atölyesi</title>
    <style>
        :root {
    --primary-color: #00ff00;
    --background-color: #000000;
    --text-color: var(--primary-color); /* Text color'ı primary-color'a bağla */
    --border-color: var(--primary-color);
}

.timer-mode, 
h3, 
h4,
.stat-item h4 {
    color: var(--primary-color);
}
        
        body {
            font-family: Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 0; /* Padding'i kaldırıyoruz */
        }
        
        /* Grid düzenini güncelle */
.container {
    display: grid;
    grid-template-columns: 1.2fr 0.1fr 1.7fr 0.8fr; /* Sağa yeni sütun ekliyoruz */
    grid-template-rows: 300px 200px 1fr; /* Üst, orta ve alt satırlar */
    gap: 20px;
    width: 100vw; /* Tüm ekran genişliğini kapla */
    height: 100vh; /* Tüm ekran yüksekliğini kapla */
    margin: 0; /* Ortalamayı kaldır */
    padding: 20px; /* Container'a padding ekliyoruz */
    box-sizing: border-box; /* Kenar boşluklarını hesaba kat */
}
        
        .box {
            border: 3px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 10px 2px rgba(0, 255, 0, 0.5); /* Neon gölge */
        }
        
        /* 1. Kutunun içeriğini yukarı taşıma */
#box1 {
    grid-column: 1;
    grid-row: 1;
    display: flex;
    flex-direction: column;
    align-items: center; /* Ortalamak için */
    justify-content: center; /* Dikey ortalama */
    padding-top: 1px; /* İçeriği yukarı taşı */
    font-family: 'Poppins', sans-serif; /* Yeni font */
}

/* "Pomodoro Sayacı" başlığı */
#box1 h3 {
    font-size: 1.5rem; /* Daha büyük font */
    font-weight: 600; /* Kalınlık */
    margin-bottom: 5px; /* Alt boşluk */
    text-align: center; /* Ortala */
    color: var(--primary-color); /* Yeşil renk */
}

/* "Çalışma Modu" yazısı */
#timer-mode {
    font-size: 1.2rem; /* Daha büyük font */
    font-weight: 400; /* Normal kalınlık */
    margin-top: 5px; /* Üst boşluk */
    text-align: center; /* Ortala */
    color: var(--text-color); /* Varsayılan renk */
}

/* Zeminle olan boşluğu artır */
.timer-controls {
    margin-bottom: 15px; /* Daha fazla boşluk */
}
        
        #box2 {
            grid-column: 2;
            grid-row: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }
        
        #box3 {
            grid-column: 3;
            grid-row: 1 / span 2;
        }
        
        
        #box4 {
    display: flex;
    flex-direction: column;
    gap: 6px;
    grid-column: 1 / span 2;
    grid-row: 2
}

.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    background-color: rgba(0, 0, 0, 0.8);
   
}

.stat-item h4 {
    font-size: 1.2rem;
    margin: 0;
    color: var(--text-color);
}

.stat-value {
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--primary-color);
}
        
        #box5 {
            grid-column: 1 / span 3;
            grid-row: 3;
        }
        
        /* Pomodoro Timer Styles */
        /* Sayaç Çizgisi */
        .timer-display {
    font-size: 2.5rem;
    font-weight: bold;
    text-align: center;
    margin: 10px 0;
    padding: 10px;
    border: 3px solid var(--primary-color);
    border-radius: 10px;
    box-shadow: 0 0 10px var(--primary-color); /* Dinamik gölge */
    color: var(--primary-color); /* Sayaç rengini primary-color'a bağla */
}
        
        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: auto;
        }
        
        button {
            background-color: var(--background-color);
            color: var(--text-color);
            border: 2px solid var(--border-color);
            border-radius: 5px;
            padding: 8px 12px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        button:hover {
            background-color: var(--primary-color);
            color: var(--background-color);
        }
        
        .settings-panel {
            display: none;
            padding: 10px;
            background-color: rgba(0, 0, 0, 0.8);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }
        
        .settings-panel.active {
            display: block;
        }
        
        .setting-item {
            margin: 10px 0;
        }
        
        /* Progress Bar Styles - Dikey Bar */
        .progress-bar {
            width: 30px; /* Dikey bar genişliği */
            height: 100%; /* Kutunun tamamını kapla */
            background-color: var(--background-color);
            border: 2px solid var(--border-color);
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            width: 100%; /* Dikey barın genişliği */
            height: 0%; /* Başlangıçta boş */
            background-color: var(--primary-color);
            position: absolute;
            bottom: 0; /* Aşağıdan yukarıya doğru dolacak */
            transition: height 1s;
        }
        
        /* Todo List Styles */
        .todo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .todo-input {
            width: 97%;
            padding: 8px;
            margin-top: 10px;
            background-color: var(--background-color);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            border-radius: 4px;
        }
        
        .todo-list {
            list-style-type: none;
            padding: 0;
            margin-top: 10px;
            overflow-y: auto;
            max-height: 250px;
        }
        
        .todo-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 255, 0, 0.3);
        }
        
        .todo-item.completed span {
            text-decoration: line-through;
            opacity: 0.7;
        }
        
        /* Stats Styles - Metinleri Kutucuğa Sığdırma */
        .stats-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            justify-content: space-between;
            padding: 5px 0;
        }
        
        .stat-item {
            text-align: center;
            margin: 5px 0;
        }
        
        .stat-item h4 {
            margin: 5px 0;
            font-size: 0.9rem;
        }
        
        .stat-value {
            font-size: 1.1rem;
            font-weight: bold;
            margin: 0;
        }
        
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 5;
        }
        
        .overlay.active {
            display: block;
        }

        .week-stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 10px;
    margin-top: 10px;
}


/* Mevcut CSS içine eklenecek */
.theme-colors {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 8px;
}

.color-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 2px solid #333;
    cursor: pointer;
    transition: transform 0.2s;
}

.color-btn:hover {
    transform: scale(1.1);
}

.color-btn.active {
    border: 3px solid #fff;
}

.day-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    padding: 10px;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-color);
    font-size: 0.9rem;
    text-align: center;
}

.day-item h4 {
    margin: 5px 0;
    font-size: 1rem;
    font-weight: bold;
}

.day-item .day-hours {
    font-size: 1.2rem;
    font-weight: bold;
    color: var(--primary-color);
}

/* Box 6: Sağ tarafa tam boy */
#box6 {
    grid-column: 4; /* En sağdaki sütun */
    grid-row: 1 / span 3; /* Üstten alta kadar */
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.sound-controls {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}

.radio-list {
    flex-grow: 1;
    overflow-y: auto;
    border-top: 2px solid var(--border-color);
    padding-top: 10px;
}

.radio-list ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

.radio-list li {
    padding: 10px;
    border: 1px solid var(--border-color);
    border-radius: 5px;
    margin-bottom: 10px;
    text-align: center;
    cursor: pointer;
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-color);
    transition: background-color 0.3s;
}

.radio-list li:hover {
    background-color: var(--primary-color);
    color: var(--background-color);
}

/* .radio-list'ten sonra ekleyin */
.donations {
    flex-grow: 1;
    border-top: 2px solid var(--border-color);
    padding-top: 10px;
    margin-top: 10px;
}

.donors-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.donors-list li {
    padding: 10px;
    border: 1px solid var(--border-color);
    border-radius: 5px;
    margin-bottom: 10px;
    text-align: center;
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-color);
    font-size: 0.9rem;
    box-shadow: 0 0 5px rgba(0, 255, 0, 0.3);
}

/* Varsayılan masaüstü düzeni (mevcut düzen) */
.container {
    display: grid;
    grid-template-columns: 1.2fr 0.1fr 1.7fr 0.8fr; /* Masaüstü için sütun düzeni */
    grid-template-rows: 300px 200px 1fr; /* Satır düzeni */
    gap: 20px;
    width: 100vw;
    height: 100vh;
    margin: 0;
    padding: 20px;
    box-sizing: border-box;
}

/* Mobil cihazlar için düzenleme */
@media (max-width: 768px) {
    .container {
        grid-template-columns: 1fr; /* Tek sütun düzeni */
        grid-template-rows: auto; /* Satır yüksekliği otomatik */
        gap: 15px;
        height: auto; /* Yükseklik otomatik */
        padding: 10px;
    }

    .box {
        width: 100%; /* Kutular tam genişlikte */
        padding: 10px;
    }

    #box1, #box2, #box3, #box4, #box5, #box6 {
        grid-column: 1; /* Tüm kutular tek sütunda */
        grid-row: auto; /* Sıralı yerleşim */
    }

    .progress-bar {
        width: 100%; /* Dikey bar yerine yatay bar */
        height: 20px; /* Daha ince bar */
    }

    .progress-fill {
        height: 100%; /* Yatay bar için doluluk */
        width: 0%; /* Başlangıçta boş */
        bottom: auto; /* Yatay bar için yukarıdan aşağıya dolma */
    }

    .sound-controls {
        flex-direction: row; /* Ses kontrollerini yatay hizala */
        justify-content: space-between;
    }

    .radio-list ul {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .donations {
        margin-top: 20px;
    }
}

/* Daha küçük cihazlar (telefonlar) için düzenleme */
@media (max-width: 480px) {
    .container {
        padding: 5px;
        gap: 10px;
    }

    .box {
        padding: 8px;
    }

    h3, h4 {
        font-size: 1rem; /* Başlık boyutlarını küçült */
    }

    .stat-value {
        font-size: 1.2rem; /* İstatistik değerlerini küçült */
    }

    .todo-input {
        font-size: 0.9rem; /* Görev giriş alanını küçült */
    }

    button {
        font-size: 0.8rem; /* Buton yazı boyutunu küçült */
        padding: 6px 10px;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <!-- Box 1: Pomodoro Timer -->
        <div class="box" id="box1">
            <h3>Pomodoro Sayacı</h3>
            <div class="timer-display" id="timer">25:00</div>
            <div class="timer-mode" id="timer-mode">Çalışma Modu</div>
            <div class="timer-controls">
                <button id="start-btn">Başlat</button>
                <button id="stop-btn">Bitir</button>
                <button id="switch-btn">Değiştir</button>
                <button id="reset-btn">Reset</button>
                <button id="settings-btn">⚙️</button>
            </div>
        </div>
        
        <!-- Box 2: Progress Bar -->
        <div class="box" id="box2">
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>
        
        <!-- Box 3: To-Do List -->
        <div class="box" id="box3">
            <div class="todo-header">
                <h3>Günlük Görevler</h3>
            </div>
            <input type="text" class="todo-input" id="todo-input" placeholder="Yeni görev ekle ve Enter'a bas">
            <ul class="todo-list" id="todo-list"></ul>
        </div>
        
        <!-- Box 4: Stats -->
        <div class="box" id="box4">
            <div class="stat-item">
                <h4>🔥 Streak</h4>
                <div class="stat-value" id="streak-value">0 gün</div>
            </div>
            <div class="stat-item">
                <h4>⏱️ Toplam Çalışma</h4>
                <div class="stat-value" id="total-time-value">0 saat 0 dk</div>
            </div>
            <div class="stat-item">
                <h4>📊 Günlük Ortalama</h4>
                <div class="stat-value" id="daily-average-value">0 saat 0 dk</div>
            </div>
        </div>
        
        <!-- Box 5: Future Use -->
        <div class="box" id="box5">
            <h3>📅 Haftalık Çalışma</h3>
            <div class="week-stats" id="week-stats">
                <!-- Günler burada dinamik olarak oluşturulacak -->
            </div>
        </div>

        <!-- Box 6: Background Sounds -->
        <div class="box" id="box6">
            <h3>🎵 Arkaplan Sesleri</h3>
            <div class="sound-controls">
                <button id="play-sound">Başlat</button>
                <button id="pause-sound">Durdur</button>
                <label for="volume-control">Ses:</label>
                <input type="range" id="volume-control" min="0" max="1" step="0.1" value="0.5">
            </div>
            <div class="radio-list">
                <h4>Playlist - Radyo Seçim</h4>
                <ul id="radio-stations">
                    <li data-url="http://media-ice.musicradio.com/ClassicFMMP3">Classic FM</li>
                    <li data-url="http://stream.srg-ssr.ch/m/rsc_de/mp3_128">Radio Swiss Classic</li>
                    <li data-url="https://stream.wqxr.org/wqxr.mp3">WQXR - Classical Radio</li>
                    <li data-url="https://drive.google.com/file/d/1azNWy_PXcrX5x1RF-OAkgfb450H09BDx/view?usp=sharing">Yağmur Sesi</li>
                    <li data-url="https://drive.google.com/file/d/1azNWy_PXcrX5x1RF-OAkgfb450H09BDx/view?usp=sharing">Klasik Müzik</li>
                </ul>
            </div>
            <div class="donations">
                <h4>💝 Bağışlar</h4>
                <ul class="donors-list">
                    <li>Me**** Tu*** Ka*******</li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- Settings Panel -->
    <div class="overlay" id="overlay"></div>
    <div class="settings-panel" id="settings-panel">
        <h3>Ayarlar</h3>
        <div class="setting-item">
            <label>Tema Rengi:</label>
            <div class="theme-colors">
                <!-- Neon Renkler -->
                <button class="color-btn" data-color="#00ff00" style="background-color: #00ff00"></button>
                <button class="color-btn" data-color="#ff00ff" style="background-color: #ff00ff"></button>
                <button class="color-btn" data-color="#00ffff" style="background-color: #00ffff"></button>
                <!-- Pastel Renkler -->
                <button class="color-btn" data-color="#98FB98" style="background-color: #98FB98"></button>
                <button class="color-btn" data-color="#FFB6C1" style="background-color: #FFB6C1"></button>
                <button class="color-btn" data-color="#87CEEB" style="background-color: #87CEEB"></button>
            </div>
        </div>
        <div class="setting-item">
            <label for="work-time">Çalışma Süresi (dakika):</label>
            <input type="number" id="work-time" min="1" max="120" value="25">
        </div>
        <div class="setting-item">
            <label for="break-time">Mola Süresi (dakika):</label>
            <input type="number" id="break-time" min="1" max="60" value="5">
        </div>
        <div class="setting-item">
            <button id="save-settings">Kaydet</button>
            <button id="cancel-settings">İptal</button>
        </div>
    </div>
    
    <script>
        // DOM Elements
        const timerDisplay = document.getElementById('timer');
        const timerMode = document.getElementById('timer-mode');
        const startBtn = document.getElementById('start-btn');
        const stopBtn = document.getElementById('stop-btn');
        const switchBtn = document.getElementById('switch-btn');
        const resetBtn = document.getElementById('reset-btn');
        const settingsBtn = document.getElementById('settings-btn');
        const progressFill = document.getElementById('progress-fill');
        const settingsPanel = document.getElementById('settings-panel');
        const overlay = document.getElementById('overlay');
        const saveSettingsBtn = document.getElementById('save-settings');
        const cancelSettingsBtn = document.getElementById('cancel-settings');
        const workTimeInput = document.getElementById('work-time');
        const breakTimeInput = document.getElementById('break-time');
        const todoInput = document.getElementById('todo-input');
        const todoList = document.getElementById('todo-list');
        const streakValue = document.getElementById('streak-value');
        const totalTimeValue = document.getElementById('total-time-value');
        const dailyAverageValue = document.getElementById('daily-average-value');

        // Timer variables
        let timer;
        let isRunning = false;
        let isWorkMode = true;
        let isStopwatchMode = false;
        let minutes = 25;
        let seconds = 0;
        let workTime = 25;
        let breakTime = 5;
        let totalWorkTime = 0; // in seconds
        let startTime = 0;
        let elapsedTime = 0;
        
        // Stats variables
        let streak = 0;
        let dailySessions = [];
        
        // Load data from localStorage
        function loadData() {
            const data = JSON.parse(localStorage.getItem('pomodoroData')) || {};
            workTime = data.workTime || 25;
            breakTime = data.breakTime || 5;
            totalWorkTime = data.totalWorkTime || 0;
            streak = data.streak || 0;
            dailySessions = data.dailySessions || [];
            
            // Check if we need to reset todos for a new day
            const lastDate = data.lastDate || new Date().toDateString();
            if (lastDate !== new Date().toDateString()) {
                // It's a new day, clear todos
                localStorage.removeItem('todos');
                // Update last date
                saveData();
            }
            
            // Update stats display
            updateStatsDisplay();
            updateWeekStats();
            
            // Update timer display with the loaded work time
            minutes = workTime;
            seconds = 0;
            updateTimerDisplay();
            
            // Load todos
            loadTodos();
            
            // Update settings inputs
            workTimeInput.value = workTime;
            breakTimeInput.value = breakTime;
        }
        
        // Save data to localStorage
        function saveData() {
            const data = {
                workTime,
                breakTime,
                totalWorkTime,
                streak,
                dailySessions,
                lastDate: new Date().toDateString()
            };
            localStorage.setItem('pomodoroData', JSON.stringify(data));
        }
        
// Mevcut script içine eklenecek
// Tema değişkenleri
const root = document.documentElement;
const colorBtns = document.querySelectorAll('.color-btn');

// Tema rengini uygula
function applyThemeColor(color) {
    // Ana renkleri güncelle
    root.style.setProperty('--primary-color', color);
    
    // Gölge rengini hesapla (rgba formatında)
    const rgb = hexToRgb(color);
    const shadowColor = `rgba(${rgb.r}, ${rgb.g}, ${rgb.b}, 1.2)`;
    
    // CSS özelliklerini güncelle
    document.querySelectorAll('.box').forEach(box => {
        box.style.boxShadow = `0 0 10px ${shadowColor}`;
    });
    
    // Timer display gölgesini güncelle
    document.querySelector('.timer-display').style.boxShadow = `0 0 10px ${color}`;
    
    // Aktif renk butonunu işaretle
    colorBtns.forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.color === color) {
            btn.classList.add('active');
        }
    });
    
    // Temayı localStorage'a kaydet
    localStorage.setItem('themeColor', color);
}

// Hex renk kodunu RGB'ye çevir
function hexToRgb(hex) {
    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
    } : null;
}

// Renk butonlarına tıklama olayı ekle
colorBtns.forEach(btn => {
    btn.addEventListener('click', () => {
        const color = btn.dataset.color;
        applyThemeColor(color);
    });
});

// Sayfa yüklendiğinde kaydedilmiş temayı uygula
document.addEventListener('DOMContentLoaded', () => {
    const savedColor = localStorage.getItem('themeColor');
    if (savedColor) {
        applyThemeColor(savedColor);
    }
});

        // Initialize the timer display
        function updateTimerDisplay() {
            const displayMinutes = String(minutes).padStart(2, '0');
            const displaySeconds = String(seconds).padStart(2, '0');
            timerDisplay.textContent = `${displayMinutes}:${displaySeconds}`;
            
            // Update progress bar
            if (isWorkMode && !isStopwatchMode) {
                const totalSeconds = workTime * 60;
                const remainingSeconds = minutes * 60 + seconds;
                const progressPercentage = (1 - remainingSeconds / totalSeconds) * 100;
                progressFill.style.height = `${progressPercentage}%`;
            } else if (!isWorkMode && !isStopwatchMode) {
                const totalSeconds = breakTime * 60;
                const remainingSeconds = minutes * 60 + seconds;
                const progressPercentage = (1 - remainingSeconds / totalSeconds) * 100;
                progressFill.style.height = `${progressPercentage}%`;
            }
        }
        
        // Update the mode display
        function updateModeDisplay() {
            if (isStopwatchMode) {
                timerMode.textContent = 'Kronometre Modu';
            } else if (isWorkMode) {
                timerMode.textContent = 'Çalışma Modu';
            } else {
                timerMode.textContent = 'Mola Modu';
            }
        }
        
        // Start the timer
        function startTimer() {
    if (isRunning) {
        // Pause
        clearInterval(timer);
        isRunning = false;
        startBtn.textContent = 'Başlat';
        return;
    }

    isRunning = true;
    startBtn.textContent = 'Duraklat';

    if (isStopwatchMode) {
        // Kronometre modu: Yukarı say
        startTime = Date.now() - elapsedTime; // Kaldığı yerden devam et
        timer = setInterval(() => {
            elapsedTime = Date.now() - startTime;
            const totalSeconds = Math.floor(elapsedTime / 1000);
            minutes = Math.floor(totalSeconds / 60);
            seconds = totalSeconds % 60;
            updateTimerDisplay();
        }, 1000);
    } else {
        // Pomodoro modu: Aşağı say
        timer = setInterval(() => {
            if (seconds === 0) {
                if (minutes === 0) {
                    // Süre doldu
                    clearInterval(timer);
                    isRunning = false;
                    startBtn.textContent = 'Başlat';
                    playAlertSound();

                    if (isWorkMode) {
                        // Çalışma modu tamamlandı, mola moduna geç
                        totalWorkTime += workTime * 60;
                        updateStreak();
                        saveData();
                        updateStatsDisplay();
                        updateWeekStats();

                        isWorkMode = false;
                        minutes = breakTime;
                        seconds = 0;

                        playAlertSound();
                        updateModeDisplay();
                    } else {
                        // Mola modu tamamlandı, dur ve kullanıcıdan başlatmasını bekle
                        isWorkMode = true;
                        minutes = workTime;
                        seconds = 0;

                        playAlertSound();
                        updateModeDisplay();
                    }
                } else {
                    // Dakikayı azalt
                    minutes--;
                    seconds = 59;
                }
            } else {
                // Saniyeyi azalt
                seconds--;
            }

            updateTimerDisplay();
        }, 1000);
    }
}
        
        // Stop the timer
function stopTimer() {
    clearInterval(timer); // Zamanlayıcıyı durdur
    if (!isRunning) return;

    isRunning = false;
    startBtn.textContent = 'Başlat';

    if (isStopwatchMode) {
        // Kronometre modunda geçen süreyi toplam çalışma süresine ekle
        const elapsedSeconds = Math.floor(elapsedTime / 1000); // Geçen süreyi saniye olarak al
        totalWorkTime += elapsedSeconds; // Toplam çalışma süresine ekle
        elapsedTime = 0; // Kronometreyi sıfırla
        minutes = 0;
        seconds = 0;
    } else if (isWorkMode) {
        // Çalışma modunda geçen süreyi ekle
        const totalSeconds = workTime * 60;
        const remainingSeconds = minutes * 60 + seconds;
        const elapsedWorkTime = totalSeconds - remainingSeconds;
        totalWorkTime += elapsedWorkTime;
        minutes = workTime;
        seconds = 0;
    } else {
        // Mola modunda sıfırla
        minutes = breakTime;
        seconds = 0;
    }

    updateStreak(); // Streak'i güncelle
    saveData(); // Verileri kaydet
    updateStatsDisplay(); // İstatistikleri güncelle
    updateWeekStats();
    updateTimerDisplay(); // Sayaç ekranını güncelle
}

        // Reset the timer
        function resetTimer() {
            clearInterval(timer);
            isRunning = false;
            startBtn.textContent = 'Başlat';
            
            if (isStopwatchMode) {
                elapsedTime = 0;
                minutes = 0;
                seconds = 0;
            } else {
                if (isWorkMode) {
                    minutes = workTime;
                } else {
                    minutes = breakTime;
                }
                seconds = 0;
            }
            
            updateTimerDisplay();
        }
        
        // Switch between pomodoro and stopwatch modes
        function switchMode() {
            clearInterval(timer);
            isRunning = false;
            startBtn.textContent = 'Başlat';
            
            if (isStopwatchMode) {
                // Switch to pomodoro
                isStopwatchMode = false;
                isWorkMode = true;
                minutes = workTime;
                seconds = 0;
                progressFill.style.height = '0%';
            } else {
                // Switch to stopwatch
                isStopwatchMode = true;
                elapsedTime = 0;
                minutes = 0;
                seconds = 0;
                progressFill.style.height = '0%';
            }
            
            updateTimerDisplay();
            updateModeDisplay();
        }
        
        // Open/close settings panel
        function toggleSettings() {
            settingsPanel.classList.toggle('active');
            overlay.classList.toggle('active');
        }
        
        // Save settings
        function saveSettings() {
            workTime = parseInt(workTimeInput.value) || 25;
            breakTime = parseInt(breakTimeInput.value) || 5;
            
            if (!isRunning) {
                if (!isStopwatchMode) {
                    if (isWorkMode) {
                        minutes = workTime;
                    } else {
                        minutes = breakTime;
                    }
                    seconds = 0;
                    updateTimerDisplay();
                }
            }
            
            saveData();
            toggleSettings();
        }
        
        // Play alert sound (simplified without actual sound for now)
        function playAlertSound() {
    const audio = new Audio('notification.mp3'); // Ses dosyasının yolu
    audio.play();
}
        
        // Update streak calculation
function updateStreak() {
    const today = new Date().toDateString();
    let todaySession = dailySessions.find(session => session.date === today);
    
    if (!todaySession) {
        // First session today
        todaySession = {
            date: today,
            totalTime: 0 // Başlangıçta 0, sonra ekleyeceğiz
        };
        dailySessions.push(todaySession);
        
        // Check if the last session was yesterday
        if (dailySessions.length > 1) {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toDateString();
            
            const yesterdaySession = dailySessions.find(session => session.date === yesterdayStr);
            
            if (yesterdaySession) {
                // Continue streak
                streak++;
            } else {
                // Reset streak
                streak = 1;
            }
        } else {
            // First ever session
            streak = 1;
        }
    }
    
    // Add time to today's session
    if (isStopwatchMode) {
        todaySession.totalTime += Math.floor(elapsedTime / 1000);
    } else if (isWorkMode) {
        const totalSeconds = workTime * 60;
        const remainingSeconds = minutes * 60 + seconds;
        const elapsedWorkTime = totalSeconds - remainingSeconds;
        todaySession.totalTime += elapsedWorkTime;
    }
}
        
       // Update stats display
       function updateStatsDisplay() {
    // Update streak
    streakValue.textContent = `${streak} gün`;
    
    // Update total time
    const totalHours = Math.floor(totalWorkTime / 3600);
    const totalMinutes = Math.floor((totalWorkTime % 3600) / 60);
    totalTimeValue.textContent = `${totalHours} saat ${totalMinutes} dk`;
    
    // Update daily average
    if (dailySessions.length > 0) {
        // Sadece benzersiz günleri sayalım
        const uniqueDates = new Set(dailySessions.map(session => session.date));
        const totalSessionTime = dailySessions.reduce((acc, session) => acc + session.totalTime, 0);
        const avgDailySeconds = totalSessionTime / uniqueDates.size;
        const avgHours = Math.floor(avgDailySeconds / 3600);
        const avgMinutes = Math.floor((avgDailySeconds % 3600) / 60);
        dailyAverageValue.textContent = `${avgHours} saat ${avgMinutes} dk`;
    } else {
        dailyAverageValue.textContent = '0 saat 0 dk';
    }
}
        // Todo List Functions
        function addTodo(text) {
            if (!text) return;
            
            const todoItem = document.createElement('li');
            todoItem.className = 'todo-item';
            
            const todoText = document.createElement('span');
            todoText.textContent = text;
            
            const todoActions = document.createElement('div');
            
            const completeBtn = document.createElement('button');
            completeBtn.textContent = '✓';
            completeBtn.addEventListener('click', () => {
                todoItem.classList.toggle('completed');
                saveTodos();
            });
            
            const deleteBtn = document.createElement('button');
            deleteBtn.textContent = '✗';
            deleteBtn.addEventListener('click', () => {
                todoList.removeChild(todoItem);
                saveTodos();
            });
            
            todoActions.appendChild(completeBtn);
            todoActions.appendChild(deleteBtn);
            
            todoItem.appendChild(todoText);
            todoItem.appendChild(todoActions);
            
            todoList.appendChild(todoItem);
            
            // Save to localStorage
            saveTodos();
        }
        
        function saveTodos() {
            const todos = [];
            document.querySelectorAll('.todo-item').forEach(item => {
                todos.push({
                    text: item.querySelector('span').textContent,
                    completed: item.classList.contains('completed')
                });
            });
            
            localStorage.setItem('todos', JSON.stringify(todos));
        }
        
        function loadTodos() {
            const todos = JSON.parse(localStorage.getItem('todos')) || [];
            
            todos.forEach(todo => {
                const todoItem = document.createElement('li');
                todoItem.className = 'todo-item';
                if (todo.completed) {
                    todoItem.classList.add('completed');
                }
                
                const todoText = document.createElement('span');
                todoText.textContent = todo.text;
                
                const todoActions = document.createElement('div');
                
                const completeBtn = document.createElement('button');
                completeBtn.textContent = '✓';
                completeBtn.addEventListener('click', () => {
                    todoItem.classList.toggle('completed');
                    saveTodos();
                });
                
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = '✗';
                deleteBtn.addEventListener('click', () => {
                    todoList.removeChild(todoItem);
                    saveTodos();
                });
                
                todoActions.appendChild(completeBtn);
                todoActions.appendChild(deleteBtn);
                
                todoItem.appendChild(todoText);
                todoItem.appendChild(todoActions);
                
                todoList.appendChild(todoItem);
            });
        }
        
        // Event Listeners
        startBtn.addEventListener('click', startTimer);
        stopBtn.addEventListener('click', stopTimer);
        resetBtn.addEventListener('click', resetTimer);
        switchBtn.addEventListener('click', switchMode);
        settingsBtn.addEventListener('click', toggleSettings);
        saveSettingsBtn.addEventListener('click', saveSettings);
        cancelSettingsBtn.addEventListener('click', toggleSettings);
        
        todoInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                addTodo(todoInput.value);
                todoInput.value = '';
            }
        });
        
        // Initialize
        loadData();
        updateModeDisplay();
        
        // Initial timer display
        updateTimerDisplay();

        function updateWeekStats() {
    const weekStatsContainer = document.getElementById('week-stats');
    weekStatsContainer.innerHTML = ''; // Önce temizle

    const daysOfWeek = ['Pazartesi', 'Salı', 'Çarşamba', 'Perşembe', 'Cuma', 'Cumartesi', 'Pazar'];
    const today = new Date();
    const currentWeek = [];

    // Haftanın günlerini oluştur
    for (let i = 0; i < 7; i++) {
        const day = new Date(today);
        day.setDate(today.getDate() - today.getDay() + i + 1); // Haftanın günlerini al
        currentWeek.push(day.toDateString());
    }

    // Günleri ve çalışma sürelerini ekle
    currentWeek.forEach((date, index) => {
        const dayName = daysOfWeek[index];
        const session = dailySessions.find(session => session.date === date);
        const hours = session ? Math.floor(session.totalTime / 3600) : 0;
        const minutes = session ? Math.floor((session.totalTime % 3600) / 60) : 0;

        const dayItem = document.createElement('div');
        dayItem.className = 'day-item';

        dayItem.innerHTML = `
            <h4>${dayName}</h4>
            <div class="day-hours">${hours} saat ${minutes} dk</div>
        `;

        weekStatsContainer.appendChild(dayItem);
    });
}

// Ses oynatıcı
const audioPlayer = new Audio();
audioPlayer.volume = 0.5; // Varsayılan ses seviyesi

// DOM Elemanları
const playSoundBtn = document.getElementById('play-sound');
const pauseSoundBtn = document.getElementById('pause-sound');
const volumeControl = document.getElementById('volume-control');
const radioStations = document.getElementById('radio-stations');

// Oynat/Durdur Butonları
playSoundBtn.addEventListener('click', () => {
    if (audioPlayer.src) {
        audioPlayer.play();
    } else {
        alert('Lütfen bir radyo istasyonu seçin!');
    }
});

pauseSoundBtn.addEventListener('click', () => {
    audioPlayer.pause();
});

// Ses Seviyesi Kontrolü
volumeControl.addEventListener('input', (e) => {
    audioPlayer.volume = e.target.value;
});

// Radyo İstasyonu Seçimi
radioStations.addEventListener('click', (e) => {
    if (e.target.tagName === 'LI') {
        const stationUrl = e.target.getAttribute('data-url');
        const stationName = e.target.textContent;
        
        // Radyo istasyonları için uyarı kontrolü
        if (stationName === 'Classic FM' || 
            stationName === 'Radio Swiss Classic' || 
            stationName === 'WQXR - Classical Radio') {
            
            if (confirm('⚠️ Radyolarda araya insan konuşmaları girebilir! Devam etmek istiyor musunuz?')) {
                audioPlayer.src = stationUrl;
                audioPlayer.play();
                alert(`${stationName} çalıyor!`);
            }
        } else {
            // Yerel ses dosyaları için normal akış
            audioPlayer.src = stationUrl;
            audioPlayer.play();
            alert(`${stationName} çalıyor!`);
        }
    }
});
    </script>
</body>
<footer style="text-align: center; margin-top: 20px; color: var(--text-color); font-size: 0.8rem;">
    <p>©OdakAtölyesi - Bir KoseiMedya kuruluşu. Tüm hakları saklıdır.</p>

</html>
